<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>MTCaptcha Test (Fixed)</title>

<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #mtcaptcha-container { width: 320px; margin-bottom: 12px; }
  #result { margin-top: 12px; color: #c00; }
</style>

<!-- MTCaptcha required -->
<script>
  // OFFICIAL test key for localhost
  var mtcaptchaConfig = {
    sitekey: "MTPublic-MNY8Xo0SG", 
    render: "auto",                // auto works better on mobile
    theme: "light",
    "lang": "en",
    "fallback": "iframe"           // IMPORTANT: fixes Brave blocking
  };
</script>

<!-- Recommended single loader instead of 2 scripts -->
<script async src="https://service.mtcaptcha.com/mtcv1/client/mtcaptcha.min.js"></script>

</head>

<body>

<h2>MTCaptcha â€“ Working Localhost Test</h2>

<form id="demoForm">
  <div id="mtcaptcha-container" class="mtcaptcha"></div>

  <input type="hidden" id="mtcaptcha-verifiedtoken" name="mtcaptcha-verifiedtoken">

  <br>
  <button type="submit">Submit</button>
  <button type="button" id="refreshBtn">Refresh CAPTCHA</button>
</form>

<p id="result"></p>


<script>
// Wait until MTCaptcha API is fully ready
function mtReady(cb) {
  if (window.mtcaptcha && mtcaptcha.getVerifiedToken) return cb();
  const t = setInterval(() => {
    if (window.mtcaptcha && mtcaptcha.getVerifiedToken) {
      clearInterval(t);
      cb();
    }
  }, 100);
}

mtReady(() => {
  // Update token every 300ms
  setInterval(() => {
    let token = mtcaptcha.getVerifiedToken();
    if (token) {
      document.getElementById("mtcaptcha-verifiedtoken").value = token;
    }
  }, 300);

  // Refresh button
  document.getElementById("refreshBtn").onclick = () => {
    if (mtcaptcha.reset) {
      mtcaptcha.reset();    // Simple, correct reset call
      document.getElementById("result").textContent = "CAPTCHA refreshed.";
    } else {
      document.getElementById("result").textContent = "MTCaptcha not ready.";
    }
  };

  // Form submit check
  document.getElementById("demoForm").addEventListener("submit", (e) => {
    let token = document.getElementById("mtcaptcha-verifiedtoken").value;
    if (!token) {
      e.preventDefault();
      document.getElementById("result").textContent = "Please solve the CAPTCHA.";
    } else {
      document.getElementById("result").textContent = "Form submitted!";
    }
  });

});
</script>

</body>
</html>